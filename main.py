import asyncio
import os
from telegram import InlineKeyboardMarkup, InlineKeyboardButton, Update
from telegram.ext import Application, CommandHandler, ContextTypes

# –•–µ–Ω–¥–ª–µ—Ä –∫–æ–º–∞–Ω–¥—ã /start
async def start(update: Update, context: ContextTypes.DEFAULT_TYPE):
    welcome_text = """
üëã –ü—Ä–∏–≤–µ—Ç!  

–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ *Smooth* ‚Äî —Ç–≤–æ–π –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–π –º–æ–±–∏–ª—å–Ω—ã–π –ø–æ–º–æ—â–Ω–∏–∫ –ø–æ —É—Ö–æ–¥—É –∑–∞ –∫–æ–∂–µ–π.  

–ó–¥–µ—Å—å —Ç—ã –º–æ–∂–µ—à—å:  
‚úÖ –ü–æ–ª—É—á–∏—Ç—å –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—É—é –ø–æ–¥–±–æ—Ä–∫—É —É—Ö–æ–¥–æ–≤—ã—Ö —Å—Ä–µ–¥—Å—Ç–≤  
‚úÖ –°–æ–∑–¥–∞—Ç—å –∫–∞–ª–µ–Ω–¥–∞—Ä—å —É—Ö–æ–¥–∞ —Å –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è–º–∏  
‚úÖ –û—Ç—Å–ª–µ–∂–∏–≤–∞—Ç—å —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å —É—Ö–æ–¥–æ–≤—ã—Ö –ø—Ä–æ–¥—É–∫—Ç–æ–≤  
‚úÖ –ê–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è –∫–æ–∂–∏ –ª–∏—Ü–∞ —Å AI-–ø–æ–º–æ—â–Ω–∏–∫–æ–º  

–ù–∞–∂–º–∏ –∫–Ω–æ–ø–∫—É –Ω–∏–∂–µ, —á—Ç–æ–±—ã –Ω–∞—á–∞—Ç—å ‚§µÔ∏è
    """

    # üëá –∑–∞–º–µ–Ω–∏—Ç–µ –Ω–∞ –∏–º—è –≤–∞—à–µ–≥–æ –±–æ—Ç–∞ (username, –±–µ–∑ @)
    bot_username = "firstttttttttry_bot"
    app_url = f"https://t.me/{bot_username}?startapp"

    keyboard = InlineKeyboardMarkup([
        [InlineKeyboardButton("üöÄ –ù–∞—á–∞—Ç—å", url=app_url)]
    ])

    await update.message.reply_text(
        text=welcome_text,
        parse_mode="Markdown",
        reply_markup=keyboard
    )

# –ó–∞–ø—É—Å–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
async def main():
    token = os.getenv('TELEGRAM_BOT_TOKEN')
    if not token:
        print("‚ùå –û—à–∏–±–∫–∞: –ù–µ –Ω–∞–π–¥–µ–Ω —Ç–æ–∫–µ–Ω –±–æ—Ç–∞!")
        print("–£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é –æ–∫—Ä—É–∂–µ–Ω–∏—è TELEGRAM_BOT_TOKEN")
        return

    application = Application.builder().token(token).build()
    application.add_handler(CommandHandler("start", start))

    print("‚úÖ –ë–æ—Ç –∑–∞–ø—É—â–µ–Ω...")
    await application.run_polling()

if __name__ == '__main__':
    import sys
    if sys.platform.startswith('win'):
        asyncio.set_event_loop_policy(asyncio.WindowsSelectorEventLoopPolicy())
    asyncio.run(main())
